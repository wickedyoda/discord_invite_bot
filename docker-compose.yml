services:
  discord_invite_bot:
    build:
      context: .
    container_name: discord_role_bot
    env_file:
      - .env
    environment:
      DISCORD_TOKEN: ${DISCORD_TOKEN:-}
      GUILD_ID: ${GUILD_ID:-}
      BOT_LOG_CHANNEL_ID: ${BOT_LOG_CHANNEL_ID:-}
      GENERAL_CHANNEL_ID: ${GENERAL_CHANNEL_ID:-0}
      DATA_DIR: ${DATA_DIR:-data}
      LOG_DIR: ${LOG_DIR:-/logs}
      LOG_HARDEN_FILE_PERMISSIONS: ${LOG_HARDEN_FILE_PERMISSIONS:-true}
      LOG_RETENTION_DAYS: ${LOG_RETENTION_DAYS:-90}
      LOG_ROTATION_INTERVAL_DAYS: ${LOG_ROTATION_INTERVAL_DAYS:-1}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
      CONTAINER_LOG_LEVEL: ${CONTAINER_LOG_LEVEL:-ERROR}
      DISCORD_LOG_LEVEL: ${DISCORD_LOG_LEVEL:-INFO}
      FORUM_BASE_URL: ${FORUM_BASE_URL:-https://forum.gl-inet.com}
      FORUM_MAX_RESULTS: ${FORUM_MAX_RESULTS:-5}
      DOCS_MAX_RESULTS_PER_SITE: ${DOCS_MAX_RESULTS_PER_SITE:-2}
      DOCS_INDEX_TTL_SECONDS: ${DOCS_INDEX_TTL_SECONDS:-3600}
      SEARCH_RESPONSE_MAX_CHARS: ${SEARCH_RESPONSE_MAX_CHARS:-1900}
      KICK_PRUNE_HOURS: ${KICK_PRUNE_HOURS:-72}
      MODERATOR_ROLE_ID: ${MODERATOR_ROLE_ID:-1294957416294645771}
      ADMIN_ROLE_ID: ${ADMIN_ROLE_ID:-1138302148292116551}
      MOD_LOG_CHANNEL_ID: ${MOD_LOG_CHANNEL_ID:-1311820410269995009}
      CSV_ROLE_ASSIGN_MAX_NAMES: ${CSV_ROLE_ASSIGN_MAX_NAMES:-500}
      firmware_notification_channel: ${firmware_notification_channel:-}
      FIRMWARE_NOTIFICATION_CHANNEL: ${FIRMWARE_NOTIFICATION_CHANNEL:-}
      FIRMWARE_NOTIFY_CHANNEL_ID: ${FIRMWARE_NOTIFY_CHANNEL_ID:-}
      FIRMWARE_FEED_URL: ${FIRMWARE_FEED_URL:-https://gl-fw.remotetohome.io/}
      firmware_check_schedule: ${firmware_check_schedule:-*/30 * * * *}
      FIRMWARE_CHECK_SCHEDULE: ${FIRMWARE_CHECK_SCHEDULE:-}
      FIRMWARE_CHECK_INTERVAL_SECONDS: ${FIRMWARE_CHECK_INTERVAL_SECONDS:-}
      FIRMWARE_REQUEST_TIMEOUT_SECONDS: ${FIRMWARE_REQUEST_TIMEOUT_SECONDS:-30}
      FIRMWARE_RELEASE_NOTES_MAX_CHARS: ${FIRMWARE_RELEASE_NOTES_MAX_CHARS:-900}
      WEB_ENABLED: ${WEB_ENABLED:-true}
      WEB_BIND_HOST: ${WEB_BIND_HOST:-0.0.0.0}
      WEB_PORT: ${WEB_PORT:-8080}
      WEB_SESSION_TIMEOUT_MINUTES: ${WEB_SESSION_TIMEOUT_MINUTES:-5}
      WEB_PUBLIC_BASE_URL: ${WEB_PUBLIC_BASE_URL:-}
      WEB_ENV_FILE: ${WEB_ENV_FILE:-/app/.env}
      WEB_RESTART_ENABLED: ${WEB_RESTART_ENABLED:-true}
      WEB_GITHUB_WIKI_URL: ${WEB_GITHUB_WIKI_URL:-http://discord.glinet.wickedyoda.com/wiki}
      WEB_ADMIN_DEFAULT_USERNAME: ${WEB_ADMIN_DEFAULT_USERNAME:-admin@example.com}
      WEB_ADMIN_DEFAULT_EMAIL: ${WEB_ADMIN_DEFAULT_EMAIL:-}
      WEB_ADMIN_DEFAULT_PASSWORD: ${WEB_ADMIN_DEFAULT_PASSWORD:-Ab!12xy}
      WEB_ADMIN_SESSION_SECRET: ${WEB_ADMIN_SESSION_SECRET:-}
      WEB_SESSION_COOKIE_SECURE: ${WEB_SESSION_COOKIE_SECURE:-true}
      WEB_SESSION_COOKIE_SAMESITE: ${WEB_SESSION_COOKIE_SAMESITE:-Lax}
      WEB_TRUST_PROXY_HEADERS: ${WEB_TRUST_PROXY_HEADERS:-true}
      WEB_ENFORCE_CSRF: ${WEB_ENFORCE_CSRF:-true}
      WEB_ENFORCE_SAME_ORIGIN_POSTS: ${WEB_ENFORCE_SAME_ORIGIN_POSTS:-true}
      WEB_HARDEN_FILE_PERMISSIONS: ${WEB_HARDEN_FILE_PERMISSIONS:-true}
      WEB_DISCORD_CATALOG_TTL_SECONDS: ${WEB_DISCORD_CATALOG_TTL_SECONDS:-120}
      WEB_DISCORD_CATALOG_FETCH_TIMEOUT_SECONDS: ${WEB_DISCORD_CATALOG_FETCH_TIMEOUT_SECONDS:-20}
      WEB_BULK_ASSIGN_TIMEOUT_SECONDS: ${WEB_BULK_ASSIGN_TIMEOUT_SECONDS:-300}
      WEB_BULK_ASSIGN_MAX_UPLOAD_BYTES: ${WEB_BULK_ASSIGN_MAX_UPLOAD_BYTES:-2097152}
      WEB_BULK_ASSIGN_REPORT_LIST_LIMIT: ${WEB_BULK_ASSIGN_REPORT_LIST_LIMIT:-50}
      WEB_BOT_PROFILE_TIMEOUT_SECONDS: ${WEB_BOT_PROFILE_TIMEOUT_SECONDS:-20}
      WEB_AVATAR_MAX_UPLOAD_BYTES: ${WEB_AVATAR_MAX_UPLOAD_BYTES:-2097152}
    ports:
      - "127.0.0.1:${WEB_HOST_PORT:-8080}:${WEB_PORT:-8080}"
    volumes:
      - ./data:/app/data
      - ./logs:/logs
      - ./.env:/app/.env
    restart: unless-stopped
